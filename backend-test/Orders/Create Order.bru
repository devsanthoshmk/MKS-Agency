meta {
  name: Create Order
  type: http
  seq: 1
}

post {
  url: {{base_url}}/api/orders
  body: json
  auth: none
}

headers {
  Authorization: Bearer {{auth_token}}
  Content-Type: application/json
}

body:json {
  {
    "items": [
      {
        "id": "prod_test_001",
        "name": "Test Product",
        "slug": "test-product-001",
        "price": 999,
        "quantity": 2,
        "images": ["https://example.com/image.jpg"]
      }
    ],
    "shipping": {
      "name": "Santhosh MK",
      "phone": "9876543210",
      "email": "santhosh@example.com",
      "address": "123, Test Street, Anna Nagar",
      "city": "Chennai",
      "state": "Tamil Nadu",
      "postal": "600040",
      "country": "India"
    },
    "subtotal": 1998,
    "shippingFee": 99,
    "total": 2097,
    "isGuest": false
  }
}

vars:post-response {
  order_id: res.body.orderId
  order_number: res.body.orderNumber
}

tests {
  expect(res.status).to.equal(200)
  expect(res.body.success).to.equal(true)
  expect(res.body).to.have.property("orderId")
  expect(res.body).to.have.property("orderNumber")
  expect(res.body.status).to.equal("PENDING_VERIFICATION")
}
